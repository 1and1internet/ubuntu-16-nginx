#!/usr/bin/env bash

SITE_FOLDER=/var/www/html
CUSTOMER_NGINX_CONF=$SITE_FOLDER/nginx.conf

function do_sighup {
    echo -n "SIGHUP sent at "; date
    kill -HUP $(cat /var/run/nginx.pid)
}

function loop_forever {
    while [ 1 ]; do
        inotifywait $CUSTOMER_NGINX_CONF && do_sighup || inotifywait $SITE_FOLDER
    done
}

loop_forever > /var/log/nginx/reloader.log
